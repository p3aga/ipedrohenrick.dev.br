---
import type { Page, GetStaticPaths } from "astro";
import { type CollectionEntry } from "astro:content";
import SiteBase from "@/layouts/SiteBase.astro";
import PostPreview from "@/components/blog/PostPreview.astro";
import { getOrderedBlogPosts } from "@/utils/blog";


export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const allPostsByDate = await getOrderedBlogPosts();

  return paginate(allPostsByDate, {
    pageSize: 20,
  });
};

interface Props {
  page: Page<CollectionEntry<"blog">>;
}

const { page } = Astro.props;
---

<SiteBase title={ `Blog pÃ¡g ${page}` }>
  <section>
    <h1 class="text-3xl font-black">Posts</h1>
    <div>
      {
        page.data.map((post) => (
          <PostPreview 
            id={ post.id }
            title={ post.data.title }
            description={ post.data.description }
            pubDate={ post.data.pubDate }
            tags={ post.data.tags }
          />
        ))
      }
    </div>
  </section>
</SiteBase>
